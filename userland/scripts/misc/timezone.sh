#!/bin/sh

TZ="/tmp/tz"
if [ "$1" != "set" ]; then
	index=`rgdb -g /time/timezone`
	tz=`rgdb -g $TZ/zone:$index/gen`
	ds=`rgdb -g /time/daylightsaving`
	if [ "$ds" = "1" ]; then
		tz="$tz"`rgdb -g $TZ/zone:$index/dst`
	fi
	echo $tz > /etc/TZ
	exit 0
fi

RGDB=rgdb
USA="M4.1.0/02:00:00,M10.5.0/02:00:00"
$RGDB -s $TZ/zone:1/name	"(GMT-12:00) International Date Line West"
$RGDB -s $TZ/zone:1/gen		"GMT+12:00"
$RGDB -s $TZ/zone:1/dst		""
$RGDB -s $TZ/zone:2/name	"(GMT-11:00) Midway Island, Samoa"
$RGDB -s $TZ/zone:2/gen		"GMT+11:00"
$RGDB -s $TZ/zone:2/dst		""
$RGDB -s $TZ/zone:3/name	"(GMT-10:00) Hawaii"
$RGDB -s $TZ/zone:3/gen		"GMT+10:00"
$RGDB -s $TZ/zone:3/dst		""
$RGDB -s $TZ/zone:4/name	"(GMT-09:00) Alaska"
$RGDB -s $TZ/zone:4/gen		"GMT+09:00"
$RGDB -s $TZ/zone:4/dst		"GDT+09:00,$USA"
$RGDB -s $TZ/zone:5/name	"(GMT-08:00) Pacific Time (US & Canada); Tijuana"
$RGDB -s $TZ/zone:5/gen		"PST+08:00"
$RGDB -s $TZ/zone:5/dst		"PDT+09:00,$USA"
$RGDB -s $TZ/zone:6/name	"(GMT-07:00) Arizona"
$RGDB -s $TZ/zone:6/gen		"GMT+07:00"
$RGDB -s $TZ/zone:6/dst		""
$RGDB -s $TZ/zone:7/name	"(GMT-07:00) Chihuahua, La Paz, Mazatlan"
$RGDB -s $TZ/zone:7/gen		"GMT+07:00"
$RGDB -s $TZ/zone:7/dst		"GDT+07:00,$USA"
$RGDB -s $TZ/zone:8/name	"(GMT-07:00) Mountain Time (US & Canada)"
$RGDB -s $TZ/zone:8/gen		"GMT+07:00"
$RGDB -s $TZ/zone:8/dst		"GDT+07:00,$USA"
$RGDB -s $TZ/zone:9/name	"(GMT-06:00) Central America"
$RGDB -s $TZ/zone:9/gen		"GMT+06:00"
$RGDB -s $TZ/zone:9/dst		""
$RGDB -s $TZ/zone:10/name	"(GMT-06:00) Central Time (US & Canada)"
$RGDB -s $TZ/zone:10/gen	"GMT+06:00"
$RGDB -s $TZ/zone:10/dst	"GDT+06:00,$USA"
$RGDB -s $TZ/zone:11/name	"(GMT-06:00) Guadalajara, Mexico City, Monterrey"
$RGDB -s $TZ/zone:11/gen	"GMT+06:00"
$RGDB -s $TZ/zone:11/dst	"GDT+06:00,$USA"
$RGDB -s $TZ/zone:12/name	"(GMT-06:00) Saskatchewan"
$RGDB -s $TZ/zone:12/gen	"GMT+06:00"
$RGDB -s $TZ/zone:12/dst	""
$RGDB -s $TZ/zone:13/name	"(GMT-05:00) Bogota, Lima, Quito"
$RGDB -s $TZ/zone:13/gen	"GMT+05:00"
$RGDB -s $TZ/zone:13/dst	""
$RGDB -s $TZ/zone:14/name	"(GMT-05:00) Eastern Time (US & Canada)"
$RGDB -s $TZ/zone:14/gen	"EST+05:00"
$RGDB -s $TZ/zone:14/dst	"EDT+05:00,$USA"
$RGDB -s $TZ/zone:15/name	"(GMT-05:00) Indiana (East)"
$RGDB -s $TZ/zone:15/gen	"EST+05:00"
$RGDB -s $TZ/zone:15/dst	""
$RGDB -s $TZ/zone:16/name	"(GMT-04:00) Atlantic Time (Canada)"
$RGDB -s $TZ/zone:16/gen	"GMT+04:00"
$RGDB -s $TZ/zone:16/dst	"GDT+04:00,$USA"
$RGDB -s $TZ/zone:17/name	"(GMT-04:00) Caracas, La Paz"
$RGDB -s $TZ/zone:17/gen	"GMT+04:00"
$RGDB -s $TZ/zone:17/dst	""
$RGDB -s $TZ/zone:18/name	"(GMT-04:00) Santiago"
$RGDB -s $TZ/zone:18/gen	"GMT+04:00"
$RGDB -s $TZ/zone:18/dst	"GDT+04:00,M10.2.6/00:00:00,M3.2.6/00:00:00"
$RGDB -s $TZ/zone:19/name	"(GMT-03:30) Newfoundland"
$RGDB -s $TZ/zone:19/gen	"GMT+03:30"
$RGDB -s $TZ/zone:19/dst	"GDT+03:30,M4.1.0/00:01:00,/M10.5.0/00:01:00"
$RGDB -s $TZ/zone:20/name	"(GMT-03:00) Brasilia"
$RGDB -s $TZ/zone:20/gen	"GMT+03:00"
$RGDB -s $TZ/zone:20/dst	""
$RGDB -s $TZ/zone:21/name	"(GMT-03:00) Buenos Aires, Georgetown"
$RGDB -s $TZ/zone:21/gen	"GMT+03:00"
$RGDB -s $TZ/zone:21/dst	""
$RGDB -s $TZ/zone:22/name	"(GMT-03:00) Greenland"
$RGDB -s $TZ/zone:22/gen	"GMT+03:00"
$RGDB -s $TZ/zone:22/dst	"GDT+03:00,$USA"
$RGDB -s $TZ/zone:23/name	"(GMT-02:00) Mid-Atlantic"
$RGDB -s $TZ/zone:23/gen	"GMT+02:00"
$RGDB -s $TZ/zone:23/dst	""
$RGDB -s $TZ/zone:24/name	"(GMT-01:00) Azores"
$RGDB -s $TZ/zone:24/gen	"GMT+01:00"
$RGDB -s $TZ/zone:24/dst	"GDT+01:00,M3.5.0/00:00:00,M10.5.0/01:00:00"
$RGDB -s $TZ/zone:25/name	"(GMT-01:00) Cape Verde Is."
$RGDB -s $TZ/zone:25/gen	"GMT+01:00"
$RGDB -s $TZ/zone:25/dst	""
$RGDB -s $TZ/zone:26/name	"(GMT) Casablanca, Monrovia"
$RGDB -s $TZ/zone:26/gen	"GMT"
$RGDB -s $TZ/zone:26/dst	""
$RGDB -s $TZ/zone:27/name	"(GMT) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London"
$RGDB -s $TZ/zone:27/gen	"GMT"
$RGDB -s $TZ/zone:27/dst	"GDT,M3.5.0/01:00:00,M10.5.0/02:00:00"
$RGDB -s $TZ/zone:28/name	"(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna"
$RGDB -s $TZ/zone:28/gen	"GMT-01:00"
$RGDB -s $TZ/zone:28/dst	"GDT-01:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:29/name	"(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague"
$RGDB -s $TZ/zone:29/gen	"GMT-01:00"
$RGDB -s $TZ/zone:29/dst	"GDT-01:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:30/name	"(GMT+01:00) Brussels, Copenhagen, Madrid, Paris"
$RGDB -s $TZ/zone:30/gen	"GMT-01:00"
$RGDB -s $TZ/zone:30/dst	"GDT-01:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:31/name	"(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb"
$RGDB -s $TZ/zone:31/gen	"GMT-01:00"
$RGDB -s $TZ/zone:31/dst	"GDT-01:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:32/name	"(GMT+01:00) West Central Africa"
$RGDB -s $TZ/zone:32/gen	"GMT-01:00"
$RGDB -s $TZ/zone:32/dst	""
$RGDB -s $TZ/zone:33/name	"(GMT+02:00) Athens, Istanbul, Minsk"
$RGDB -s $TZ/zone:33/gen	"GMT-02:00"
$RGDB -s $TZ/zone:33/dst	"GDT-02:00,M3.5.0/03:00:00,M10.5.0/04:00:00"
$RGDB -s $TZ/zone:34/name	"(GMT+02:00) Bucharest"
$RGDB -s $TZ/zone:34/gen	"GMT-02:00"
$RGDB -s $TZ/zone:34/dst	"GDT-02:00,M3.5.0/03:00:00,M10.5.0/04:00:00"
$RGDB -s $TZ/zone:35/name	"(GMT+02:00) Cairo"
$RGDB -s $TZ/zone:35/gen	"GMT-02:00"
$RGDB -s $TZ/zone:35/dst	"GDT-02:00,M4.5.5/00:00:00,M9.5.4/00:00:00"
$RGDB -s $TZ/zone:36/name	"(GMT+02:00) Harare, Pretoria"
$RGDB -s $TZ/zone:36/gen	"GMT-02:00"
$RGDB -s $TZ/zone:36/dst	""
$RGDB -s $TZ/zone:37/name	"(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius"
$RGDB -s $TZ/zone:37/gen	"GMT-02:00"
$RGDB -s $TZ/zone:37/dst	"GDT-02:00,M3.5.0/03:00:00,M10.5.0/04:00:00"
$RGDB -s $TZ/zone:38/name	"(GMT+02:00) Jerusalem"
$RGDB -s $TZ/zone:38/gen	"GMT-02:00"
$RGDB -s $TZ/zone:38/dst	""
$RGDB -s $TZ/zone:39/name	"(GMT+03:00) Baghdad"
$RGDB -s $TZ/zone:39/gen	"GMT-03:00"
$RGDB -s $TZ/zone:39/dst	""
$RGDB -s $TZ/zone:40/name	"(GMT+03:00) Kuwait, Riyadh"
$RGDB -s $TZ/zone:41/gen	"GMT-03:00"
$RGDB -s $TZ/zone:41/dst	""
$RGDB -s $TZ/zone:41/name	"(GMT+03:00) Moscow, St. Petersburg, Volgograd"
$RGDB -s $TZ/zone:41/gen	"GMT-03:00"
$RGDB -s $TZ/zone:41/dst	"GDT-03:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:42/name	"(GMT+03:00) Nairobi"
$RGDB -s $TZ/zone:42/gen	"GMT-03:00"
$RGDB -s $TZ/zone:42/dst	""
$RGDB -s $TZ/zone:43/name	"(GMT+03:30) Tehran"
$RGDB -s $TZ/zone:43/gen	"GMT-03:00"
$RGDB -s $TZ/zone:43/dst	""
$RGDB -s $TZ/zone:44/name	"(GMT+04:00) Abu Dhabi, Muscat"
$RGDB -s $TZ/zone:44/gen	"GMT-04:00"
$RGDB -s $TZ/zone:44/dst	""
$RGDB -s $TZ/zone:45/name	"(GMT+04:00) Baku, Tbilisi, Yerevan"
$RGDB -s $TZ/zone:45/gen	"GMT-04:00"
$RGDB -s $TZ/zone:45/dst	"GDT-04:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:46/name	"(GMT+04:30) Kabul"
$RGDB -s $TZ/zone:46/gen	"GMT-04:30"
$RGDB -s $TZ/zone:46/dst	""
$RGDB -s $TZ/zone:47/name	"(GMT+05:00) Ekaterinburg"
$RGDB -s $TZ/zone:47/gen	"GMT-05:00"
$RGDB -s $TZ/zone:47/dst	"GDT-05:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:48/name	"(GMT+05:00) Islamabad, Karachi, Tashkent"
$RGDB -s $TZ/zone:48/gen	"GMT-05:00"
$RGDB -s $TZ/zone:48/dst	""
$RGDB -s $TZ/zone:49/name	"(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi"
$RGDB -s $TZ/zone:49/gen	"GMT-05:30"
$RGDB -s $TZ/zone:49/dst	""
$RGDB -s $TZ/zone:50/name	"(GMT+05:45) Kathmandu"
$RGDB -s $TZ/zone:50/gen	"GMT-05:45"
$RGDB -s $TZ/zone:50/dst	""
$RGDB -s $TZ/zone:51/name	"(GMT+06:00) Almaty, Novosibirsk"
$RGDB -s $TZ/zone:51/gen	"GMT-06:00"
$RGDB -s $TZ/zone:51/dst	"GDT-06:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:52/name	"(GMT+06:00) Astana, Dhaka"
$RGDB -s $TZ/zone:52/gen	"GMT-06:00"
$RGDB -s $TZ/zone:52/dst	""
$RGDB -s $TZ/zone:53/name	"(GMT+06:00) Sri Jayawardenepura"
$RGDB -s $TZ/zone:53/gen	"GMT-06:00"
$RGDB -s $TZ/zone:53/dst	""
$RGDB -s $TZ/zone:54/name	"(GMT+06:30) Rangoon"
$RGDB -s $TZ/zone:54/gen	"GMT-06:30"
$RGDB -s $TZ/zone:54/dst	""
$RGDB -s $TZ/zone:55/name	"(GMT+07:00) Bangkok, Hanoi, Jakarta"
$RGDB -s $TZ/zone:55/gen	"GMT-07:00"
$RGDB -s $TZ/zone:55/dst	""
$RGDB -s $TZ/zone:56/name	"(GMT+07:00) Krasnoyarsk"
$RGDB -s $TZ/zone:56/gen	"GMT-07:00"
$RGDB -s $TZ/zone:56/dst	"GDT-07:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:57/name	"(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi"
$RGDB -s $TZ/zone:57/gen	"CST-08:00"
$RGDB -s $TZ/zone:57/dst	""
$RGDB -s $TZ/zone:58/name	"(GMT+08:00) Irkutsk, Ulaan Bataar"
$RGDB -s $TZ/zone:58/gen	"GMT-08:00"
$RGDB -s $TZ/zone:58/dst	"GDT-08:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:59/name	"(GMT+08:00) Kuala Lumpur, Singapore"
$RGDB -s $TZ/zone:59/gen	"GMT-08:00"
$RGDB -s $TZ/zone:59/dst	""
$RGDB -s $TZ/zone:60/name	"(GMT+08:00) Perth"
$RGDB -s $TZ/zone:60/gen	"GMT-08:00"
$RGDB -s $TZ/zone:60/dst	""
$RGDB -s $TZ/zone:61/name	"(GMT+08:00) Taipei"
$RGDB -s $TZ/zone:61/gen	"GMT-08:00"
$RGDB -s $TZ/zone:61/dst	""
$RGDB -s $TZ/zone:62/name	"(GMT+09:00) Osaka, Sapporo, Tokyo"
$RGDB -s $TZ/zone:62/gen	"GMT-09:00"
$RGDB -s $TZ/zone:62/dst	""
$RGDB -s $TZ/zone:63/name	"(GMT+09:00) Seoul"
$RGDB -s $TZ/zone:63/gen	"GMT-09:00"
$RGDB -s $TZ/zone:63/dst	""
$RGDB -s $TZ/zone:64/name	"(GMT+09:00) Yakutsk"
$RGDB -s $TZ/zone:64/gen	"GMT-09:00"
$RGDB -s $TZ/zone:64/dst	"GDT-09:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:65/name	"(GMT+09:30) Adelaide"
$RGDB -s $TZ/zone:65/gen	"GMT-09:30"
$RGDB -s $TZ/zone:65/dst	"GDT-09:30,M10.5.0/02:00:00,M3.5.0/03:00:00"
$RGDB -s $TZ/zone:66/name	"(GMT+09:30) Darwin"
$RGDB -s $TZ/zone:66/gen	"GMT-09:30"
$RGDB -s $TZ/zone:66/dst	""
$RGDB -s $TZ/zone:67/name	"(GMT+10:00) Brisbane"
$RGDB -s $TZ/zone:67/gen	"GMT-10:00"
$RGDB -s $TZ/zone:67/dst	""
$RGDB -s $TZ/zone:68/name	"(GMT+10:00) Canberra, Melbourne, Sydney"
$RGDB -s $TZ/zone:68/gen	"GMT-10:00"
$RGDB -s $TZ/zone:68/dst	"GDT-10:00,M10.5.0/02:00:00,M3.5.0/03:00:00"
$RGDB -s $TZ/zone:69/name	"(GMT+10:00) Guam, Port Moresby"
$RGDB -s $TZ/zone:69/gen	"GMT-10:00"
$RGDB -s $TZ/zone:69/dst	""
$RGDB -s $TZ/zone:70/name	"(GMT+10:00) Hobart"
$RGDB -s $TZ/zone:70/gen	"GMT-10:00"
$RGDB -s $TZ/zone:70/dst	"GDT-10:00,M10.1.0/02:00:00,M3.5.0/03:00:00"
$RGDB -s $TZ/zone:71/name	"(GMT+10:00) Vladivostok"
$RGDB -s $TZ/zone:71/gen	"GMT-10:00"
$RGDB -s $TZ/zone:71/dst	"GDT-10:00,M3.5.0/02:00:00,M10.5.0/03:00:00"
$RGDB -s $TZ/zone:72/name	"(GMT+11:00) Magadan, Solomon Is., New Caledonia"
$RGDB -s $TZ/zone:72/gen	"GMT-11:00"
$RGDB -s $TZ/zone:72/dst	""
$RGDB -s $TZ/zone:73/name	"(GMT+12:00) Auckland, Wellington"
$RGDB -s $TZ/zone:73/gen	"GMT-12:00"
$RGDB -s $TZ/zone:73/dst	"GDT-12:00,M10.1.0/02:00:00,M3.5.0/03:00:00"
$RGDB -s $TZ/zone:74/name	"(GMT+12:00) Fiji, Kamchatka, Marshall Is."
$RGDB -s $TZ/zone:74/gen	"GMT-12:00"
$RGDB -s $TZ/zone:74/dst	""
$RGDB -s $TZ/zone:75/name	"(GMT+13:00) Nuku'alofa"
$RGDB -s $TZ/zone:75/gen	"GMT-13:00"
$RGDB -s $TZ/zone:75/dst	""

index=`rgdb -g /time/timezone`
tz=`rgdb -g $TZ/zone:$index/gen`
ds=`rgdb -g /time/daylightsaving`
if [ "$ds" = "1" ]; then
	tz="$tz"`rgdb -g $TZ/zone:$index/dst`
fi
echo $tz > /etc/TZ

exit 0
